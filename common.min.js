!function(){let e=/[\?&]OVERLAY_WS=([^&]+)/.exec(location.href),n=null,r=[],t=0,l={},i={},s=null,o=!1,a=!1,d=[];function c(e){if(i[e.type])for(let n of i[e.type])n(e)}void 0===window.OverlayPluginApi&&(e=e?e[1]:"ws://127.0.0.1:10501/ws"),e?(s=(e=>{r?r.push(e):n.send(JSON.stringify(e))}),function t(){(n=new WebSocket(e)).addEventListener("error",e=>{console.error(e)}),n.addEventListener("open",()=>{console.log("Connected!");let e=r;r=null;for(let n of e)s(n)}),n.addEventListener("message",e=>{try{e=JSON.parse(e.data)}catch(n){return void console.error("Invalid message received: ",e)}void 0!==e.rseq&&l[e.rseq]?(l[e.rseq](e),delete l[e.rseq]):c(e)}),n.addEventListener("close",()=>{r=[],console.log("Trying to reconnect..."),setTimeout(()=>{t()},300)})}()):(s=((e,n)=>{r?r.push([e,n]):OverlayPluginApi.callHandler(JSON.stringify(e),n)}),function e(){if(!window.OverlayPluginApi||!window.OverlayPluginApi.ready)return void setTimeout(e,300);let n=r;r=null,window.__OverlayCallback=c;for(let[e,r]of n)s(e,r)}()),window.dispatchOverlayEvent=c,window.addOverlayListener=((e,n)=>{o&&i[e]&&console.warn(`A new listener for ${e} has been registered after event transmission has already begun.\nSome events might have been missed and no cached values will be transmitted.\nPlease register your listeners before calling startOverlayEvents().`),i[e]||(i[e]=[]),i[e].push(n)}),window.removeOverlayListener=((e,n)=>{if(i[e]){let r=i[e],t=r.indexOf(n);t>-1&&r.splice(t,1)}}),window.callOverlayHandler=(e=>{let r;return n?(e.rseq=t++,r=new Promise((n,r)=>{l[e.rseq]=n}),s(e)):r=new Promise(n=>{s(e,e=>{n(null==e?null:JSON.parse(e))})}),r}),window.startOverlayEvents=(()=>{o=!1,s({call:"subscribe",events:Object.keys(i)})}),window.frameUpdate=(e=>{if(d.push(e),!a){a=!0;let e=()=>{for(let e=0;e<d.length;e++)d[e]();requestAnimationFrame(e)};requestAnimationFrame(e)}})}();